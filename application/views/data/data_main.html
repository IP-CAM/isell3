<script type="text/javascript">
    DataJs={
	loadTable:function(){
	    var row=$("#data_table_list").datagrid('getSelected');
	    if( row ){
		$.get("Data/tableStructure/"+row.table_name,function(resp){
		    var struct=App.json(resp);
		    DataJs.initTable(row.table_name,struct);
		});
	    }
	},
	initTable:function(table_name,struct){
	    for(var i in struct){
		struct[i].title=struct[i].field=struct[i].Field;
	    }
	    $('#data_grid').datagrid({
		url:"Data/tableData/"+table_name,
		width:900,
		pagination:true,
		pageSize:30,
		pageList:[30,60,120,600],
		columns:[struct]
	    });
	}
    };
</script>
<table style="width:100%">
    <tr>
	<td style="vertical-align: top;width: 205px">
	    <table class="easyui-datagrid" id="data_table_list" data-options="
		   url:'Data/permitedTableList',
		   singleSelect:true,
		   onSelect:DataJs.loadTable
		   ">
		<thead>
		    <tr>
			<th  data-options="field:'table_title',width:200">Доступные таблицы</th>
		    </tr>
		</thead>
	    </table>
	</td>
	<td style="vertical-align: top;text-align: center">
	    <div style="float: left;font-weight: bold;padding-top: 8px;">
		<img src="img/table16.png" style="width:16px;height: 16px;"> Остатки в категории: "<span id="stock_cat_name">Все</span>"
	    </div>
	    <div style="text-align: right;padding-right: 5px;">
		<span class="icon-24 icon-create" title="Добавить" onclick="Leftovers.list.create();"> </span>
		<span class="icon-24 icon-change" title="Изменить" onclick="Leftovers.list.edit();"> </span>
		<span class="icon-24 icon-delete" title="Удалить" onclick="Leftovers.list.delete();"> </span>
		<span class="icon-24" style="background-image: url(img/big_rightarrow.png);background-repeat: no-repeat;background-size: 24px 24px;" title="Перенести в другую категорию" onclick="Leftovers.list.move();"> </span>
		<span class="icon-24 icon-import" title="Импорт" onclick="Leftovers.list.import();"> </span>
		<span class="icon-24 icon-tablefilter" title="Фильтр таблицы" onclick="Leftovers.list.toggleFilter()"> </span>
		<span class="icon-24 icon-refresh" title="Обновить" onclick="Leftovers.list.reload()"> </span>
		<span class="icon-24" style="background-image: url(img/file_download.png);background-repeat: no-repeat" title="Скачать таблицу" onclick="Leftovers.list.outfile('.xlsx');"> </span>
		<span class="icon-24 icon-print" title="Печать" onclick="Leftovers.list.out('.print')"> </span>
	    </div>
	    <div id="data_grid"></div>
	</td>
    </tr>
</table>

